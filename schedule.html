<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Today's Predictions | CHan Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style> body { font-family: 'Inter', sans-serif; } </style>
</head>
<body class="bg-gray-50 text-gray-900 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-slate-900 text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="font-bold text-xl tracking-tight text-white">CHan Analytics</span>
                    <div class="hidden md:block"><div class="ml-10 flex items-baseline space-x-4"><a href="index.html" class="text-gray-300 hover:bg-slate-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors">Rankings</a><a href="matchup.html" class="text-gray-300 hover:bg-slate-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors">Matchup Simulator</a></div></div>
                </div>
            </div>
        </div>
        <div class="md:hidden" id="mobile-menu"><div class="px-2 pt-2 pb-3 space-y-1 sm:px-3"><a href="index.html" class="text-gray-300 hover:bg-slate-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Rankings</a><a href="matchup.html" class="text-gray-300 hover:bg-slate-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Matchup Simulator</a></div></div>
    </nav>

    <main class="flex-grow max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        <h1 class="text-2xl font-bold text-slate-900 mb-6">Today's Projections</h1>
        
        <div id="games-container" class="space-y-4">
            <!-- Games injected here -->
        </div>
    </main>

    <footer class="bg-white border-t border-gray-200 mt-auto py-6">
        <div class="max-w-6xl mx-auto px-4 text-center text-slate-400 text-xs">
            Automated Analysis System
        </div>
    </footer>

    <!-- Load Ratings Data -->
    <script src="teams_data.js"></script>

    <script>
        const games = [{"away": "Western Carolina", "home": "Georgia"}, {"away": "North Florida", "home": "Charleston Southern"}, {"away": "Lafayette", "home": "Charlotte"}, {"away": "Bradley", "home": "Indiana St."}, {"away": "American", "home": "VCU"}, {"away": "SIU-Edwardsville", "home": "Eastern Illinois"}, {"away": "Drake", "home": "Murray St."}, {"away": "Louisiana", "home": "Southern Miss"}, {"away": "Toccoa Falls", "home": "Gardner Webb"}, {"away": "Jackson St.", "home": "Hampton"}, {"away": "Coastal Carolina", "home": "Appalachian St."}, {"away": "Morris College", "home": "UNC Asheville"}, {"away": "Fairfield", "home": "Central Connecticut"}, {"away": "Temple", "home": "Davidson"}, {"away": "Norfolk St.", "home": "Grambling St."}, {"away": "Penn State Hazleton", "home": "Lehigh"}, {"away": "Furman", "home": "Manhattan"}, {"away": "Southern Utah", "home": "Northern Arizona"}, {"away": "Delaware St.", "home": "St. Joseph's"}, {"away": "Radford", "home": "William & Mary"}, {"away": "Georgia St.", "home": "Georgia Southern"}, {"away": "Western Illinois", "home": "Lindenwood"}, {"away": "Winthrop", "home": "North Dakota"}, {"away": "Kansas City", "home": "Oklahoma St."}, {"away": "Little Rock", "home": "Southern Indiana"}, {"away": "UT-Martin", "home": "Tennessee St."}, {"away": "Southeast Missouri", "home": "Tennessee Tech"}, {"away": "Oral Roberts", "home": "TCU"}, {"away": "Nobel University", "home": "Cal St. Bakersfield"}, {"away": "Montana Western", "home": "Idaho St."}, {"away": "Illinois St.", "home": "Southern Illinois"}, {"away": "Pepperdine", "home": "Long Beach St."}];
        const container = document.getElementById('games-container');
        
        // Math Constants
        const AVG_EFF = 106.0;
        const AVG_TEMPO = 68.5;
        const HFA = 3.2;

        if (games.length === 0) {
            container.innerHTML = '<div class="text-center text-gray-500 py-10">No games scheduled for today (or scraper failed).</div>';
        }

        games.forEach(g => {
            const home = TEAMS_DATA[g.home];
            const away = TEAMS_DATA[g.away];

            if (!home || !away) return; // Skip if team not found in ratings

            // Run Sim (Home vs Away)
            const expTempo = home.adjt + away.adjt - AVG_TEMPO;
            const expEffHome = (home.adjo + away.adjd - AVG_EFF) + HFA;
            const expEffAway = (away.adjo + home.adjd - AVG_EFF) - HFA;

            const scoreHome = (expEffHome * expTempo) / 100;
            const scoreAway = (expEffAway * expTempo) / 100;
            
            const margin = scoreHome - scoreAway;
            const winner = margin > 0 ? g.home : g.away;
            const loser = margin > 0 ? g.away : g.home;
            const winScore = Math.round(Math.max(scoreHome, scoreAway));
            const loseScore = Math.round(Math.min(scoreHome, scoreAway));
            const spread = Math.abs(margin).toFixed(1);
            
            // Win Prob
            const x = 11.5;
            const wp = (Math.pow(winScore, x)) / (Math.pow(winScore, x) + Math.pow(loseScore, x));
            const wpPct = (wp * 100).toFixed(0) + "%";

            // Render Card
            const card = document.createElement('div');
            card.className = "bg-white p-4 rounded-lg shadow border border-gray-200 flex flex-col sm:flex-row justify-between items-center";
            
            card.innerHTML = `
                <div class="flex-1 w-full flex justify-between items-center sm:block">
                    <div class="font-bold text-lg text-slate-900">
                        <a href="team.html?q=${encodeURIComponent(winner)}" class="hover:underline">${winner}</a>
                        <span class="text-gray-400 font-normal text-sm ml-1">#${TEAMS_DATA[winner].rank}</span>
                    </div>
                    <div class="text-sm text-gray-500 mt-1">
                        def. <a href="team.html?q=${encodeURIComponent(loser)}" class="hover:underline">${loser}</a>
                        <span class="text-xs text-gray-400">#${TEAMS_DATA[loser].rank}</span>
                    </div>
                </div>
                
                <div class="mt-4 sm:mt-0 flex items-center space-x-6">
                    <div class="text-center min-w-[80px]">
                        <div class="text-sm font-bold text-blue-600">${winner} -${spread}</div>
                        <div class="text-xs text-slate-500">Win Prob: ${wpPct}</div>
                    </div>
                </div>
            `;
            
            container.appendChild(card);
        });
    </script>
</body>
</html>